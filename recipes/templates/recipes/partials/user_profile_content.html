{% load static %}
<div class="container profile-page">
  <!-- –®–∞–ø–∫–∞ –ø—Ä–æ—Ñ—ñ–ª—é –∞–≤—Ç–æ—Ä–∞ -->
  <section class="profile-header">
    <h1>–ü—Ä–æ—Ñ—ñ–ª—å: {{ author.username }}</h1>
    <p>–ü—É–±–ª—ñ—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∑ –∫—É–ª—ñ–Ω–∞—Ä–Ω–∏–º–∏ —Ä–µ—Ü–µ–ø—Ç–∞–º–∏</p>
  </section>

  <!-- –ê–≤–∞—Ç–∞—Ä —ñ –¥–µ—Ç–∞–ª—ñ -->
  <section class="profile-info">
    {% if author.profile_picture %}
    <img src="{{ author.profile_picture.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar">
    {% else %}
    <img src="https://res.cloudinary.com/drbcpofzd/image/upload/v1746451012/default-avatar_gkinny.png" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar">
    {% endif %}

    <div class="user-details">
      <p><strong>–ù—ñ–∫–Ω–µ–π–º:</strong> {{ author.username }}</p>
      <p><strong>–î–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:</strong> {{ author.date_joined|date:"d.m.Y" }}</p>

      <!-- –ö–Ω–æ–ø–∫–∞ –ø—ñ–¥–ø–∏—Å–∫–∏ -->
      {% if request.user != author %}
      <form method="post" action="{% url 'toggle_follow' author.username %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">
          {% if is_following %}–í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è{% else %}–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è{% endif %}
        </button>
      </form>
      {% endif %}
    </div>

    <div class="profile-stats">
      <div class="stat-item">
        <div class="stat-value">{{ recipes.count }}</div>
        <div class="stat-label">–†–µ—Ü–µ–ø—Ç—ñ–≤</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ avg_rating|default:"0.0" }}
          {% for i in "12345" %}
            {% with num=i|add:"0" %}
              <i class="fa-star {% if avg_rating >= num %}fas{% else %}far{% endif %}"></i>
            {% endwith %}
          {% endfor %}
        </div>
        <div class="stat-label">–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥</div>
      </div>
    </div>
  </section>

  <!-- –†–µ—Ü–µ–ø—Ç–∏ –∞–≤—Ç–æ—Ä–∞ -->
  <section id="author-recipes">
    <h2 class="section-title"><i class="fas fa-book-open"></i> –†–µ—Ü–µ–ø—Ç–∏ {{ author.username }}</h2>

    {% if recipes %}
    <div class="recipes-grid">
      {% for recipe in recipes %}
      <div class="recipe-card">
        <div class="recipe-img-container">
          {% if recipe.image %}
          <img src="{{ recipe.image.url }}" alt="{{ recipe.title }}" class="recipe-img">
          {% else %}
          <div class="no-image"><i class="fas fa-utensils fa-2x"></i></div>
          {% endif %}
        </div>

        <div class="recipe-content">
          <h3 class="recipe-title">{{ recipe.title }}</h3>
          <p class="recipe-meta">
            <i class="fas fa-calendar-alt"></i> {{ recipe.created_at|date:"d.m.Y" }}
            <i class="fas fa-star"></i> {{ recipe.rating|default:"0.0" }}
          </p>
          <a href="{% url 'recipe_detail' recipe.pk %}" class="btn btn-primary">
            <i class="fas fa-eye"></i> –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
          </a>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p style="text-align: center;">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Ä–µ—Ü–µ–ø—Ç—ñ–≤ ü•≤</p>
    {% endif %}
  </section>
</div>
